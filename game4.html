<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÉ‚Äç‚ôÇÔ∏è Halloween Runner 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #fff;
            overflow: hidden;
        }
        
        #gameContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        
        #gameCanvas {
            display: block;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
        }
        
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0,0,0,0.9), rgba(26,26,46,0.95));
            color: #fff;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        
        .overlay.hidden {
            display: none;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 0 4px 12px rgba(255,107,53,0.4);
            color: #ff6b35;
        }
        
        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            color: #ffa600;
        }
        
        .rules {
            background: rgba(255,107,53,0.1);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid rgba(255,107,53,0.3);
            margin-bottom: 2rem;
            max-width: 1000px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .rules-block {
            display: flex;
            flex-direction: column;
        }
        
        .rules h3 {
            color: #4ade80;
            margin-bottom: 10px;
        }
        
        .rules ul {
            text-align: left;
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .rules li {
            margin: 5px 0;
            color: #ccc;
        }
        
        .bigBtn {
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            background: linear-gradient(145deg, #ff6b35, #ff8e53);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(255,107,53,0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 10px;
        }
        
        .bigBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(255,107,53,0.4);
        }
        
        .hud {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 5;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255,107,53,0.3);
        }
        
        .legend {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 5;
            background: rgba(0,0,0,0.8);
            padding: 10px 15px;
            border-radius: 10px;
            border: 1px solid rgba(255,107,53,0.3);
            font-size: 12px;
            color: #fff;
            white-space: nowrap;
            text-align: center;
        }
        
        .hud div {
            margin: 5px 0;
            font-size: 18px;
            font-weight: bold;
        }
        
        .score { color: #4ade80; }
        .lives { color: #ff4757; }
        .level { color: #ff6b35; }
        
        .pauseBtn {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 5;
            padding: 10px 20px;
            background: linear-gradient(145deg, #ff6b35, #ff8e53);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(255,107,53,0.3);
        }
        
        .slowTimer {
            position: absolute;
            top: 20px;
            right: 120px;
            z-index: 5;
            background: rgba(139,92,246,0.9);
            padding: 8px 12px;
            border-radius: 8px;
            border: 2px solid #8b5cf6;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }
        
        .slowIcon {
            font-size: 16px;
            margin-bottom: 2px;
        }
        
        .slowText {
            color: #fff;
            font-size: 10px;
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .slowTime {
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }
        
        .blackTimer {
            position: absolute;
            top: 20px;
            right: 200px;
            z-index: 5;
            background: rgba(0,0,0,0.9);
            padding: 8px 12px;
            border-radius: 8px;
            border: 2px solid #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }
        
        .blackIcon {
            font-size: 16px;
            margin-bottom: 2px;
        }
        
        .blackText {
            color: #fff;
            font-size: 10px;
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .blackTime {
            color: #fff;
            font-size: 14px;
            font-weight: bold;
        }
        
        .screamer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            font-weight: bold;
            text-shadow: 0 0 20px currentColor;
        }
        
        .screamer.red { background: #ff0000; color: #fff; }
        .screamer.black { background: #000; color: #fff; }
        .screamer.white { background: #fff; color: #000; }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        
        <!-- HUD -->
        <div class="hud">
            <div class="score">–û—á–∫–∏: <span id="score">0</span></div>
            <div class="lives">–ñ–∏–∑–Ω–∏: <span id="lives">3</span></div>
            <div class="level">–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span></div>
        </div>
        
        <!-- Pause Button -->
        <button class="pauseBtn" id="pauseBtn">‚è∏Ô∏è –ü–∞—É–∑–∞</button>
        
        <!-- Slow Debuff Timer -->
        <div class="slowTimer" id="slowTimer" style="display: none;">
            <div class="slowIcon">üü£</div>
            <div class="slowText">SLOW</div>
            <div class="slowTime" id="slowTime">10</div>
        </div>
        
        <!-- Black Debuff Timer -->
        <div class="blackTimer" id="blackTimer" style="display: none;">
            <div class="blackIcon">‚ö´</div>
            <div class="blackText">BLOCK</div>
            <div class="blackTime" id="blackTime">15</div>
        </div>
        
        <!-- Legend -->
        <div class="legend" id="legend">
            [üéÆ –û–ë–™–ï–ö–¢–´] [üü¢+10] [üü†+25] [üü£+30] [‚ù§Ô∏è+1‚ù§Ô∏è] [üíÄ-1‚ù§Ô∏è] [üü£SLOW] [üëπBOSS] [‚ö´BLOCK]
        </div>
        
        <!-- Start Screen -->
        <div id="startScreen" class="overlay">
            <h1>üèÉ‚Äç‚ôÇÔ∏è HALLOWEEN RUNNER üèÉ‚Äç‚ôÇÔ∏è</h1>
            <p class="subtitle">–ë–µ–≥–∏, –≤—ã–∂–∏–≤–∞–π!</p>
            
            <div class="rules">
                <div class="rules-block">
                    <h3>üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</h3>
                    <ul>
                        <li><b>‚Üë</b> - –≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</li>
                        <li><b>‚Üì</b> - –Ω–∏–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å</li>
                        <li><b>‚Üê</b> - –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ª–µ–≤–æ</li>
                        <li><b>‚Üí</b> - –¥–≤–∏–∂–µ–Ω–∏–µ –≤–ø—Ä–∞–≤–æ</li>
                    </ul>
                    
                    <h3>üéØ –¶–µ–ª—å:</h3>
                    <ul>
                        <li>–ù–∞–±—Ä–∞—Ç—å <span style="color:#4ade80;font-weight:bold;">666 –æ—á–∫–æ–≤</span></li>
                        <li>–ò–∑–±–µ–≥–∞–π—Ç–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π</li>
                        <li>–°–æ–±–∏—Ä–∞–π—Ç–µ –±–æ–Ω—É—Å—ã</li>
                        <li>–í—ã–∂–∏–≤–∞–π—Ç–µ –∫–∞–∫ –º–æ–∂–Ω–æ –¥–æ–ª—å—à–µ!</li>
                    </ul>
                    
                    <h3>üéÅ –ë–æ–Ω—É—Å—ã:</h3>
                    <ul>
                        <li><span style="color:#4ade80;">üü¢ –ó–µ–ª–µ–Ω—ã–µ</span> - +10 –æ—á–∫–æ–≤</li>
                        <li><span style="color:#ff6b35;">üü† –û—Ä–∞–Ω–∂–µ–≤—ã–µ</span> - +25 –æ—á–∫–æ–≤</li>
                        <li><span style="color:#8b5cf6;">üü£ –§–∏–æ–ª–µ—Ç–æ–≤—ã–µ</span> - +30 –æ—á–∫–æ–≤</li>
                        <li><span style="color:#ff4757;">‚ù§Ô∏è –°–µ—Ä–¥—Ü–∞</span> - +1 –∂–∏–∑–Ω—å</li>
                    </ul>
                </div>
                
                <div class="rules-block">
                    <h3>‚ö†Ô∏è –û–ø–∞—Å–Ω–æ—Å—Ç–∏:</h3>
                    <ul>
                        <li><span style="color:#ff4757;">üíÄ –ß–µ—Ä–µ–ø–∞</span> - -1 –∂–∏–∑–Ω—å</li>
                        <li><span style="color:#ff6600;">üíÄ –°–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ —á–µ—Ä–µ–ø–∞</span> - –∫–∞–∂–¥—ã–µ 50 –æ—á–∫–æ–≤, -3 –∂–∏–∑–Ω–∏</li>
                        <li><span style="color:#ff0000;">üëπ –ë–æ—Å—Å—ã</span> - –∫–∞–∂–¥—ã–µ 200 –æ—á–∫–æ–≤, -2 –∂–∏–∑–Ω–∏</li>
                        <li><span style="color:#8b5cf6;">üü£ SLOW</span> - –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ –Ω–∞ 10 —Å–µ–∫</li>
                        <li><span style="color:#000;">‚ö´ BLOCK</span> - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ª–∏–Ω–∏—é –Ω–∞ 15 —Å–µ–∫</li>
                        <li><span style="color:#ff0000;">üëª –°–∫—Ä–∏–º–µ—Ä—ã</span> - –ø—É–≥–∞—é—â–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</li>
                    </ul>
                    
                    <h3>‚è∞ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h3>
                    <ul>
                        <li>–¢–∞–π–º–µ—Ä—ã 3-2-1 –ø–µ—Ä–µ–¥ –æ–ø–∞—Å–Ω–æ—Å—Ç—è–º–∏</li>
                        <li>–û—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º–∏</li>
                        <li>–ù–µ–ª—å–∑—è –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—É—é –ª–∏–Ω–∏—é</li>
                    </ul>
                </div>
            </div>
            
            <button class="bigBtn" id="startBtn">üöÄ –°–¢–ê–†–¢</button>
        </div>
        
        <!-- Game Over Screen -->
        <div id="gameOverScreen" class="overlay hidden">
            <h1>üíÄ GAME OVER üíÄ</h1>
            <p class="subtitle">–¢—ã –Ω–µ —Å–º–æ–≥ –≤—ã–∂–∏—Ç—å...</p>
            <div class="rules">
                <h3>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
                <p>–û—á–∫–∏: <span id="finalScore" style="color:#4ade80;font-size:2rem;">0</span></p>
                <p>–£—Ä–æ–≤–µ–Ω—å: <span id="finalLevel" style="color:#ff6b35;font-size:1.5rem;">1</span></p>
            </div>
            <button class="bigBtn" id="restartBtn">üîÑ –ó–ê–ù–û–í–û</button>
        </div>
        
        <!-- Victory Screen -->
        <div id="victoryScreen" class="overlay hidden">
            <h1>üéâ –ü–û–ë–ï–î–ê! üéâ</h1>
            <p class="subtitle">–¢—ã –≤—ã–∂–∏–ª –∏ –Ω–∞–±—Ä–∞–ª 666 –æ—á–∫–æ–≤!</p>
            <div class="rules">
                <h3>–í–æ–ø—Ä–æ—Å: "–ö–ü–ö–£–ö–ü–ö–ü–£–ö–ü–£–ö"</h3>
                <p>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –ø–æ–±–µ–¥–æ–π!</p>
            </div>
            <button class="bigBtn" id="victoryRestartBtn">üéÆ –°–´–ì–†–ê–¢–¨ –ï–©–Å</button>
        </div>
        
        <!-- Pause Screen -->
        <div id="pauseScreen" class="overlay hidden">
            <h1>‚è∏Ô∏è –ü–ê–£–ó–ê</h1>
            <p class="subtitle">–ò–≥—Ä–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</p>
            <button class="bigBtn" id="resumeBtn">‚ñ∂Ô∏è –ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
        </div>
        
        <!-- Screamer -->
        <div id="screamer" class="screamer">
            <div id="screamerText">üëª</div>
        </div>
    </div>

    <script>
        (function() {
            // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const startScreen = document.getElementById('startScreen');
            const gameOverScreen = document.getElementById('gameOverScreen');
            const victoryScreen = document.getElementById('victoryScreen');
            const pauseScreen = document.getElementById('pauseScreen');
            const screamer = document.getElementById('screamer');
            const screamerText = document.getElementById('screamerText');
            
            const startBtn = document.getElementById('startBtn');
            const restartBtn = document.getElementById('restartBtn');
            const victoryRestartBtn = document.getElementById('victoryRestartBtn');
            const resumeBtn = document.getElementById('resumeBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const legend = document.getElementById('legend');
            const slowTimer = document.getElementById('slowTimer');
            const slowTime = document.getElementById('slowTime');
            const blackTimer = document.getElementById('blackTimer');
            const blackTime = document.getElementById('blackTime');
            
            const scoreEl = document.getElementById('score');
            const livesEl = document.getElementById('lives');
            const levelEl = document.getElementById('level');
            const finalScoreEl = document.getElementById('finalScore');
            const finalLevelEl = document.getElementById('finalLevel');
            
            // –†–∞–∑–º–µ—Ä—ã canvas
            let w, h;
            
            function resize() {
                w = window.innerWidth;
                h = window.innerHeight;
                canvas.width = w;
                canvas.height = h;
            }
            
            window.addEventListener('resize', resize);
            resize();
            
            // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            let gameState = 'start'; // start, playing, paused, gameOver, victory
            let gameSpeed = 2;
            let score = 0;
            let lives = 3;
            let level = 1;
            let lastTime = 0;
            
            // –ò–≥—Ä–æ–∫
            let player = {
                x: 100,
                y: h / 2,
                width: 40,
                height: 40,
                vx: 0,
                vy: 0,
                jumpPower: -15,
                gravity: 0.8,
                onGround: false,
                lane: 1, // 0 - –≤–µ—Ä—Ö, 1 - —Å–µ—Ä–µ–¥–∏–Ω–∞, 2 - –Ω–∏–∑
                speed: 5,
                maxSpeed: 8
            };
            
            // –û–±—ä–µ–∫—Ç—ã
            let obstacles = [];
            let bonuses = [];
            let debuffs = [];
            let particles = [];
            let bosses = [];
            let speedSkulls = [];
            
            // –°—á–µ—Ç—á–∏–∫–∏
            let collectedBonuses = 0;
            let countdownActive = false;
            let countdownNumber = 0;
            let countdownTime = 0;
            
            // –î–µ–±–∞—Ñ—ã
            let slowDebuffActive = false;
            let slowDebuffTime = 0;
            let slowDebuffDuration = 600; // 10 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ 60 FPS
            
            // –ß–µ—Ä–Ω—ã–π –¥–µ–±–∞—Ñ
            let blackDebuffActive = false;
            let blackDebuffTime = 0;
            let blackDebuffDuration = 900; // 15 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ 60 FPS
            let disabledLane = -1; // -1 = –Ω–µ—Ç –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏, 0-2 = –Ω–æ–º–µ—Ä –ª–∏–Ω–∏–∏
            
            // –°–∫—Ä–∏–º–µ—Ä—ã
            let screamerActive = false;
            let lastScreamerTime = 0;
            let screamerCooldown = 15000; // 15 —Å–µ–∫—É–Ω–¥
            
            // –£—Ä–æ–≤–Ω–∏ –≤—ã—Å–æ—Ç
            const lanes = [
                h * 0.25, // –í–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
                h * 0.5,   // –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
                h * 0.75   // –ù–∏–∂–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
            ];
            
            // –ö–ª–∞–≤–∏—à–∏
            let keys = {
                up: false,
                down: false,
                left: false,
                right: false
            };
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            startBtn.onclick = startGame;
            restartBtn.onclick = restartGame;
            victoryRestartBtn.onclick = restartGame;
            resumeBtn.onclick = resumeGame;
            pauseBtn.onclick = togglePause;
            
            // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
            window.addEventListener('keydown', (e) => {
                if (gameState !== 'playing') return;
                
                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        // –ü—Ä—ã–∂–æ–∫ —É–±—Ä–∞–Ω
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        if (!keys.up) {
                            keys.up = true;
                            changeLane(-1);
                        }
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        if (!keys.down) {
                            keys.down = true;
                            changeLane(1);
                        }
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        keys.left = true;
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        keys.right = true;
                        break;
                }
            });
            
            window.addEventListener('keyup', (e) => {
                switch(e.code) {
                    case 'Space':
                        // –ü—Ä—ã–∂–æ–∫ —É–±—Ä–∞–Ω
                        break;
                    case 'ArrowUp':
                        keys.up = false;
                        break;
                    case 'ArrowDown':
                        keys.down = false;
                        break;
                    case 'ArrowLeft':
                        keys.left = false;
                        break;
                    case 'ArrowRight':
                        keys.right = false;
                        break;
                }
            });
            
            // –ò–≥—Ä–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            function startGame() {
                gameState = 'playing';
                startScreen.classList.add('hidden');
                gameOverScreen.classList.add('hidden');
                victoryScreen.classList.add('hidden');
                pauseScreen.classList.add('hidden');
                legend.style.display = 'block';
                
                // –°–±—Ä–æ—Å –∏–≥—Ä—ã
                score = 0;
                lives = 3;
                level = 1;
                gameSpeed = 2;
                obstacles = [];
                bonuses = [];
                debuffs = [];
                particles = [];
                bosses = [];
                speedSkulls = [];
                collectedBonuses = 0;
                countdownActive = false;
                slowDebuffActive = false;
                slowDebuffTime = 0;
                blackDebuffActive = false;
                blackDebuffTime = 0;
                disabledLane = -1;
                
                // –°–±—Ä–æ—Å –∏–≥—Ä–æ–∫–∞
                player.x = 100;
                player.y = lanes[1];
                player.vx = 0;
                player.vy = 0;
                player.lane = 1;
                player.onGround = true;
                
                lastScreamerTime = 0;
                screamerActive = false;
                
                updateHUD();
                gameLoop();
            }
            
            function restartGame() {
                startGame();
            }
            
            function resumeGame() {
                gameState = 'playing';
                pauseScreen.classList.add('hidden');
                legend.style.display = 'block';
                slowTimer.style.display = 'none';
                gameLoop();
            }
            
            function togglePause() {
                if (gameState === 'playing') {
                    gameState = 'paused';
                    pauseScreen.classList.remove('hidden');
                    legend.style.display = 'none';
                } else if (gameState === 'paused') {
                    resumeGame();
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –ø—Ä—ã–∂–∫–∞ —É–±—Ä–∞–Ω–∞
            
            function changeLane(direction) {
                const newLane = Math.max(0, Math.min(2, player.lane + direction));
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –ª–∏ –Ω–æ–≤–∞—è –ª–∏–Ω–∏—è
                if (disabledLane === newLane) {
                    return; // –ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—É—é –ª–∏–Ω–∏—é
                }
                
                player.lane = newLane;
                player.y = lanes[player.lane];
            }
            
            function spawnObstacle() {
                if (Math.random() < 0.012) { // –£–≤–µ–ª–∏—á–∏–ª–∏ –Ω–∞ 20%
                    let lane = Math.floor(Math.random() * 3);
                    
                    // –ï—Å–ª–∏ –ª–∏–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞, –≤—ã–±–∏—Ä–∞–µ–º –¥—Ä—É–≥—É—é
                    if (disabledLane === lane) {
                        const availableLanes = [0, 1, 2].filter(l => l !== disabledLane);
                        if (availableLanes.length > 0) {
                            lane = availableLanes[Math.floor(Math.random() * availableLanes.length)];
                        } else {
                            return; // –í—Å–µ –ª–∏–Ω–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
                        }
                    }
                    
                    obstacles.push({
                        x: w,
                        y: lanes[lane] - 15, // –°—Ç–∞–≤–∏–º –Ω–∞ –ª–∏–Ω–∏—é, –∞ –Ω–µ –ø–æ–¥ –Ω–µ–π
                        width: 30,
                        height: 30,
                        type: 'skull',
                        speed: gameSpeed + 1
                    });
                }
            }
            
            function spawnBonus() {
                if (Math.random() < 0.003) { // –ï—â–µ –±–æ–ª—å—à–µ —É–º–µ–Ω—å—à–∏–ª–∏
                    let lane = Math.floor(Math.random() * 3);
                    
                    // –ï—Å–ª–∏ –ª–∏–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞, –≤—ã–±–∏—Ä–∞–µ–º –¥—Ä—É–≥—É—é
                    if (disabledLane === lane) {
                        const availableLanes = [0, 1, 2].filter(l => l !== disabledLane);
                        if (availableLanes.length > 0) {
                            lane = availableLanes[Math.floor(Math.random() * availableLanes.length)];
                        } else {
                            return; // –í—Å–µ –ª–∏–Ω–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
                        }
                    }
                    
                    const types = ['green', 'orange', 'purple', 'heart'];
                    const type = types[Math.floor(Math.random() * types.length)];
                    
                    bonuses.push({
                        x: w,
                        y: lanes[lane] - 12, // –°—Ç–∞–≤–∏–º –Ω–∞ –ª–∏–Ω–∏—é, –∞ –Ω–µ –ø–æ–¥ –Ω–µ–π
                        width: 25,
                        height: 25,
                        type: type,
                        speed: gameSpeed
                    });
                }
            }
            
            function spawnDebuff() {
                if (Math.random() < 0.0025) { // –£–º–µ–Ω—å—à–∏–ª–∏ –≤ 2 —Ä–∞–∑–∞
                    let lane = Math.floor(Math.random() * 3);
                    
                    // –ï—Å–ª–∏ –ª–∏–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞, –≤—ã–±–∏—Ä–∞–µ–º –¥—Ä—É–≥—É—é
                    if (disabledLane === lane) {
                        const availableLanes = [0, 1, 2].filter(l => l !== disabledLane);
                        if (availableLanes.length > 0) {
                            lane = availableLanes[Math.floor(Math.random() * availableLanes.length)];
                        } else {
                            return; // –í—Å–µ –ª–∏–Ω–∏–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã
                        }
                    }
                    
                    debuffs.push({
                        x: w,
                        y: lanes[lane] - 15, // –°—Ç–∞–≤–∏–º –Ω–∞ –ª–∏–Ω–∏—é, –∞ –Ω–µ –ø–æ–¥ –Ω–µ–π
                        width: 30,
                        height: 30,
                        type: 'slow',
                        speed: gameSpeed
                    });
                }
            }
            
            function spawnBoss() {
                if (score > 0 && score % 200 === 0 && bosses.length === 0 && !countdownActive) {
                    startCountdown('boss');
                }
            }
            
            function spawnSpeedSkull() {
                if (score > 0 && score % 50 === 0 && speedSkulls.length === 0 && !countdownActive) {
                    startCountdown('speedSkull');
                }
            }
            
            function spawnBlackDebuff() {
                if (score > 0 && score % 75 === 0 && !blackDebuffActive && !countdownActive) {
                    startCountdown('blackDebuff');
                }
            }
            
            function startCountdown(type) {
                countdownActive = true;
                countdownNumber = 3;
                countdownTime = 0;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∏–ø –¥–ª—è –ø–æ—Å–ª–µ —Ç–∞–π–º–µ—Ä–∞
                window.countdownType = type;
            }
            
            function updateCountdown() {
                if (!countdownActive) return;
                
                countdownTime++;
                
                if (countdownTime >= 60) { // 1 —Å–µ–∫—É–Ω–¥–∞ –ø—Ä–∏ 60 FPS
                    countdownNumber--;
                    countdownTime = 0;
                    
                    if (countdownNumber <= 0) {
                        countdownActive = false;
                        
                        // –°–ø–∞–≤–Ω –æ–±—ä–µ–∫—Ç–∞ –ø–æ—Å–ª–µ —Ç–∞–π–º–µ—Ä–∞
                        if (window.countdownType === 'boss') {
                            spawnBossObject();
                        } else if (window.countdownType === 'speedSkull') {
                            spawnSpeedSkullObject();
                        } else if (window.countdownType === 'blackDebuff') {
                            activateBlackDebuff();
                        }
                    }
                }
            }
            
            function spawnBossObject() {
                const lane = Math.floor(Math.random() * 3);
                bosses.push({
                    x: w,
                    y: lanes[lane] - 75,
                    width: 150,
                    height: 150,
                    type: 'boss',
                    speed: gameSpeed + 0.5,
                    health: 3
                });
            }
            
            function spawnSpeedSkullObject() {
                const lane = Math.floor(Math.random() * 3);
                speedSkulls.push({
                    x: w,
                    y: lanes[lane] - 75, // –í 5 —Ä–∞–∑ –±–æ–ª—å—à–µ –æ–±—ã—á–Ω–æ–≥–æ
                    width: 150,
                    height: 150,
                    type: 'speedSkull',
                    speed: gameSpeed * 2 // –í 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ (–∑–∞–º–µ–¥–ª–µ–Ω –Ω–∞ 50%)
                });
            }
            
            function activateBlackDebuff() {
                blackDebuffActive = true;
                blackDebuffTime = 0;
                disabledLane = Math.floor(Math.random() * 3); // –°–ª—É—á–∞–π–Ω–∞—è –ª–∏–Ω–∏—è
                blackTimer.style.display = 'flex';
            }
            
            function triggerScreamer() {
                if (screamerActive) return;
                
                const now = Date.now();
                if (now - lastScreamerTime < screamerCooldown) return;
                
                screamerActive = true;
                lastScreamerTime = now;
                
                const types = ['red', 'black', 'white'];
                const type = types[Math.floor(Math.random() * types.length)];
                const texts = ['üëª', 'üíÄ', 'üò±', 'üëπ', 'üî•'];
                const text = texts[Math.floor(Math.random() * texts.length)];
                
                screamer.className = `screamer ${type}`;
                screamerText.textContent = text;
                screamer.style.display = 'flex';
                
                setTimeout(() => {
                    screamer.style.display = 'none';
                    screamerActive = false;
                }, 2000);
            }
            
            function updatePlayer(dt) {
                // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
                let currentSpeed = player.speed;
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –¥–µ–±–∞—Ñ SLOW
                if (slowDebuffActive) {
                    currentSpeed *= 0.3; // –ó–∞–º–µ–¥–ª—è–µ–º –Ω–∞ 70%
                }
                
                if (keys.left) {
                    player.vx = -currentSpeed;
                } else if (keys.right) {
                    player.vx = currentSpeed;
                } else {
                    player.vx *= 0.8; // –¢—Ä–µ–Ω–∏–µ
                }
                
                // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
                player.x += player.vx;
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
                player.x = Math.max(0, Math.min(w - player.width, player.x));
                
                // –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏—è
                if (!player.onGround) {
                    player.vy += player.gravity;
                    player.y += player.vy;
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–∑–µ–º–ª–µ–Ω–∏—è
                    if (player.y >= lanes[player.lane]) {
                        player.y = lanes[player.lane];
                        player.vy = 0;
                        player.onGround = true;
                    }
                }
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
                player.y = Math.max(0, Math.min(h - player.height, player.y));
            }
            
            function updateObjects(dt) {
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
                for (let i = obstacles.length - 1; i >= 0; i--) {
                    const obs = obstacles[i];
                    obs.x -= obs.speed;
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º
                    if (obs.x < -obs.width) {
                        obstacles.splice(i, 1);
                        continue;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
                    if (checkCollision(player, obs)) {
                        lives--;
                        obstacles.splice(i, 1);
                        createParticles(obs.x, obs.y, '#ff4757');
                        updateHUD(); // –û–±–Ω–æ–≤–ª—è–µ–º HUD –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∂–∏–∑–Ω–µ–π
                        
                        if (lives <= 0) {
                            gameOver();
                            return;
                        }
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Å—Å–æ–≤
                for (let i = bosses.length - 1; i >= 0; i--) {
                    const boss = bosses[i];
                    boss.x -= boss.speed;
                    
                    // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞ —ç–∫—Ä–∞–Ω–æ–º
                    if (boss.x < -boss.width) {
                        bosses.splice(i, 1);
                        continue;
                    }
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è —Å –±–æ—Å—Å–æ–º
                    if (checkCollision(player, boss)) {
                        lives -= 2; // –ë–æ—Å—Å –æ—Ç–Ω–∏–º–∞–µ—Ç 2 –∂–∏–∑–Ω–∏
                        boss.health--;
                        createParticles(boss.x, boss.y, '#ff0000');
                        updateHUD(); // –û–±–Ω–æ–≤–ª—è–µ–º HUD –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∂–∏–∑–Ω–µ–π
                        
                        if (boss.health <= 0) {
                            score += 100; // –ë–æ–Ω—É—Å –∑–∞ —É–±–∏–π—Å—Ç–≤–æ –±–æ—Å—Å–∞
                            bosses.splice(i, 1);
                            createParticles(boss.x, boss.y, '#4ade80');
                            updateHUD(); // –û–±–Ω–æ–≤–ª—è–µ–º HUD –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—á–∫–æ–≤
                        }
                        
                        if (lives <= 0) {
                            gameOver();
                            return;
                        }
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
                for (let i = bonuses.length - 1; i >= 0; i--) {
                    const bonus = bonuses[i];
                    bonus.x -= bonus.speed;
                    
                    if (bonus.x < -bonus.width) {
                        bonuses.splice(i, 1);
                        continue;
                    }
                    
                    if (checkCollision(player, bonus)) {
                        collectBonus(bonus);
                        bonuses.splice(i, 1);
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–µ–±–∞—Ñ–æ–≤
                for (let i = debuffs.length - 1; i >= 0; i--) {
                    const debuff = debuffs[i];
                    debuff.x -= debuff.speed;
                    
                    if (debuff.x < -debuff.width) {
                        debuffs.splice(i, 1);
                        continue;
                    }
                    
                    if (checkCollision(player, debuff)) {
                        applyDebuff(debuff);
                        debuffs.splice(i, 1);
                    }
                }
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö —á–µ—Ä–µ–ø–æ–≤
                for (let i = speedSkulls.length - 1; i >= 0; i--) {
                    const skull = speedSkulls[i];
                    skull.x -= skull.speed;
                    
                    if (skull.x < -skull.width) {
                        speedSkulls.splice(i, 1);
                        continue;
                    }
                    
                    if (checkCollision(player, skull)) {
                        lives -= 3; // –°–∫–æ—Ä–æ—Å—Ç–Ω–æ–π —á–µ—Ä–µ–ø –æ—Ç–Ω–∏–º–∞–µ—Ç 3 –∂–∏–∑–Ω–∏
                        speedSkulls.splice(i, 1);
                        createParticles(skull.x, skull.y, '#ff0000');
                        updateHUD();
                        
                        if (lives <= 0) {
                            gameOver();
                            return;
                        }
                    }
                }
            }
            
            function collectBonus(bonus) {
                switch(bonus.type) {
                    case 'green':
                        score += 10;
                        break;
                    case 'orange':
                        score += 25;
                        break;
                    case 'purple':
                        score += 30;
                        break;
                    case 'heart':
                        lives = Math.min(5, lives + 1);
                        break;
                }
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤
                collectedBonuses++;
                
                createParticles(bonus.x, bonus.y, '#4ade80');
                updateHUD();
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                if (score >= 666) {
                    victory();
                }
            }
            
            function applyDebuff(debuff) {
                if (debuff.type === 'slow') {
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –¥–µ–±–∞—Ñ SLOW –Ω–∞ 10 —Å–µ–∫—É–Ω–¥
                    slowDebuffActive = true;
                    slowDebuffTime = 0;
                    createParticles(debuff.x, debuff.y, '#8b5cf6');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
                    slowTimer.style.display = 'flex';
                }
            }
            
            function updateSlowDebuff() {
                if (slowDebuffActive) {
                    slowDebuffTime++;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
                    const remainingTime = Math.ceil((slowDebuffDuration - slowDebuffTime) / 60);
                    slowTime.textContent = remainingTime;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ –¥–µ–±–∞—Ñ–∞
                    if (slowDebuffTime >= slowDebuffDuration) {
                        slowDebuffActive = false;
                        slowDebuffTime = 0;
                        slowTimer.style.display = 'none';
                    }
                }
            }
            
            function updateBlackDebuff() {
                if (blackDebuffActive) {
                    blackDebuffTime++;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä
                    const remainingTime = Math.ceil((blackDebuffDuration - blackDebuffTime) / 60);
                    blackTime.textContent = remainingTime;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ –¥–µ–±–∞—Ñ–∞
                    if (blackDebuffTime >= blackDebuffDuration) {
                        blackDebuffActive = false;
                        blackDebuffTime = 0;
                        disabledLane = -1;
                        blackTimer.style.display = 'none';
                    }
                }
            }
            
            function createParticles(x, y, color) {
                for (let i = 0; i < 10; i++) {
                    particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 10,
                        vy: (Math.random() - 0.5) * 10,
                        life: 30,
                        color: color
                    });
                }
            }
            
            function updateParticles() {
                for (let i = particles.length - 1; i >= 0; i--) {
                    const p = particles[i];
                    p.x += p.vx;
                    p.y += p.vy;
                    p.life--;
                    
                    if (p.life <= 0) {
                        particles.splice(i, 1);
                    }
                }
            }
            
            function checkCollision(rect1, rect2) {
                return rect1.x < rect2.x + rect2.width &&
                       rect1.x + rect1.width > rect2.x &&
                       rect1.y < rect2.y + rect2.height &&
                       rect1.y + rect1.height > rect2.y;
            }
            
            function updateHUD() {
                scoreEl.textContent = score;
                livesEl.textContent = lives;
                levelEl.textContent = level;
            }
            
            function gameOver() {
                gameState = 'gameOver';
                finalScoreEl.textContent = score;
                finalLevelEl.textContent = level;
                gameOverScreen.classList.remove('hidden');
                legend.style.display = 'none';
            }
            
            function victory() {
                gameState = 'victory';
                victoryScreen.classList.remove('hidden');
                legend.style.display = 'none';
            }
            
            function render() {
                // –û—á–∏—Å—Ç–∫–∞ canvas
                ctx.clearRect(0, 0, w, h);
                
                // –§–æ–Ω —Å –ø–æ–ª–æ—Å–∞–º–∏ —É—Ä–æ–≤–Ω–µ–π
                ctx.fillStyle = 'rgba(255,107,53,0.1)';
                for (let i = 0; i < 3; i++) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –ª–∏ –ª–∏–Ω–∏—è
                    if (disabledLane === i) {
                        ctx.fillStyle = 'rgba(255,0,0,0.3)'; // –ö—Ä–∞—Å–Ω–∞—è –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏
                    } else {
                        ctx.fillStyle = 'rgba(255,107,53,0.1)';
                    }
                    ctx.fillRect(0, lanes[i] - 2, w, 4);
                }
                
                // –ò–≥—Ä–æ–∫ - —Ç—ã–∫–≤–∞
                ctx.save();
                const playerGradient = ctx.createRadialGradient(
                    player.x + player.width/2, player.y + player.height/2, 0,
                    player.x + player.width/2, player.y + player.height/2, player.width/2
                );
                playerGradient.addColorStop(0, '#ff6b35');
                playerGradient.addColorStop(0.7, '#ff8e53');
                playerGradient.addColorStop(1, '#ffa600');
                ctx.fillStyle = playerGradient;
                ctx.shadowColor = '#ff6b35';
                ctx.shadowBlur = 10;
                ctx.beginPath();
                ctx.arc(player.x + player.width/2, player.y + player.height/2, player.width/2, 0, 2*Math.PI);
                ctx.fill();
                ctx.shadowBlur = 0;
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // –ì–ª–∞–∑–∞ —Ç—ã–∫–≤—ã
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(player.x + player.width/2 - 8, player.y + player.height/2 - 6, 3, 0, 2*Math.PI);
                ctx.fill();
                ctx.beginPath();
                ctx.arc(player.x + player.width/2 + 8, player.y + player.height/2 - 6, 3, 0, 2*Math.PI);
                ctx.fill();
                
                // –†–æ—Ç —Ç—ã–∫–≤—ã
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(player.x + player.width/2, player.y + player.height/2 + 4, 6, 0, Math.PI);
                ctx.fill();
                ctx.restore();
                
                // –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
                obstacles.forEach(obs => {
                    ctx.save();
                    ctx.fillStyle = '#ff4757';
                    ctx.shadowColor = '#ff4757';
                    ctx.shadowBlur = 8;
                    ctx.beginPath();
                    ctx.arc(obs.x + obs.width/2, obs.y + obs.height/2, obs.width/2, 0, 2*Math.PI);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // –ó–Ω–∞—á–æ–∫ —á–µ—Ä–µ–ø–∞
                    ctx.fillStyle = '#fff';
                    ctx.font = '16px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('üíÄ', obs.x + obs.width/2, obs.y + obs.height/2 + 5);
                    ctx.restore();
                });
                
                // –ë–æ–Ω—É—Å—ã
                bonuses.forEach(bonus => {
                    ctx.save();
                    let color = '#4ade80';
                    let icon = 'üü¢';
                    let text = '+10';
                    
                    switch(bonus.type) {
                        case 'orange':
                            color = '#ff6b35';
                            icon = 'üü†';
                            text = '+25';
                            break;
                        case 'purple':
                            color = '#8b5cf6';
                            icon = 'üü£';
                            text = '+50';
                            break;
                        case 'heart':
                            color = '#ff4757';
                            icon = '‚ù§Ô∏è';
                            text = '+1‚ù§Ô∏è';
                            break;
                    }
                    
                    ctx.fillStyle = color;
                    ctx.shadowColor = color;
                    ctx.shadowBlur = 10;
                    ctx.beginPath();
                    ctx.arc(bonus.x + bonus.width/2, bonus.y + bonus.height/2, bonus.width/2, 0, 2*Math.PI);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // –ó–Ω–∞—á–æ–∫ –∏ —Ç–µ–∫—Å—Ç –±–æ–Ω—É—Å–∞
                    ctx.fillStyle = '#fff';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(icon, bonus.x + bonus.width/2, bonus.y + bonus.height/2 - 2);
                    ctx.font = '8px Arial';
                    ctx.fillText(text, bonus.x + bonus.width/2, bonus.y + bonus.height/2 + 8);
                    ctx.restore();
                });
                
                // –î–µ–±–∞—Ñ—ã
                debuffs.forEach(debuff => {
                    ctx.save();
                    ctx.fillStyle = '#8b5cf6';
                    ctx.shadowColor = '#8b5cf6';
                    ctx.shadowBlur = 8;
                    ctx.beginPath();
                    ctx.arc(debuff.x + debuff.width/2, debuff.y + debuff.height/2, debuff.width/2, 0, 2*Math.PI);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // –ó–Ω–∞—á–æ–∫ –∏ —Ç–µ–∫—Å—Ç –¥–µ–±–∞—Ñ–∞
                    ctx.fillStyle = '#fff';
                    ctx.font = '14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('üü£', debuff.x + debuff.width/2, debuff.y + debuff.height/2 - 2);
                    ctx.font = '8px Arial';
                    ctx.fillText('SLOW', debuff.x + debuff.width/2, debuff.y + debuff.height/2 + 8);
                    ctx.restore();
                });
                
                // –ë–æ—Å—Å—ã
                bosses.forEach(boss => {
                    ctx.save();
                    ctx.fillStyle = '#ff0000';
                    ctx.shadowColor = '#ff0000';
                    ctx.shadowBlur = 15;
                    ctx.beginPath();
                    ctx.arc(boss.x + boss.width/2, boss.y + boss.height/2, boss.width/2, 0, 2*Math.PI);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 4;
                    ctx.stroke();
                    
                    // –ó–Ω–∞—á–æ–∫ –∏ —Ç–µ–∫—Å—Ç –±–æ—Å—Å–∞
                    ctx.fillStyle = '#fff';
                    ctx.font = '24px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('üíÄ', boss.x + boss.width/2, boss.y + boss.height/2 - 5);
                    ctx.font = 'bold 16px Arial';
                    ctx.fillText('BOSS', boss.x + boss.width/2, boss.y + boss.height/2 + 15);
                    
                    // –ü–æ–ª–æ—Å–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –±–æ—Å—Å–∞
                    const healthBarWidth = boss.width;
                    const healthBarHeight = 8;
                    const healthBarX = boss.x;
                    const healthBarY = boss.y - 20;
                    
                    ctx.fillStyle = 'rgba(255,0,0,0.3)';
                    ctx.fillRect(healthBarX, healthBarY, healthBarWidth, healthBarHeight);
                    ctx.fillStyle = '#4ade80';
                    ctx.fillRect(healthBarX, healthBarY, healthBarWidth * (boss.health / 3), healthBarHeight);
                    
                    ctx.restore();
                });
                
                // –°–∫–æ—Ä–æ—Å—Ç–Ω—ã–µ —á–µ—Ä–µ–ø—ã
                speedSkulls.forEach(skull => {
                    ctx.save();
                    ctx.fillStyle = '#ff6600';
                    ctx.shadowColor = '#ff6600';
                    ctx.shadowBlur = 20;
                    ctx.beginPath();
                    ctx.arc(skull.x + skull.width/2, skull.y + skull.height/2, skull.width/2, 0, 2*Math.PI);
                    ctx.fill();
                    ctx.shadowBlur = 0;
                    ctx.strokeStyle = '#fff';
                    ctx.lineWidth = 4;
                    ctx.stroke();
                    
                    // –ó–Ω–∞—á–æ–∫ –∏ —Ç–µ–∫—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–≥–æ —á–µ—Ä–µ–ø–∞
                    ctx.fillStyle = '#fff';
                    ctx.font = '24px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText('üíÄ', skull.x + skull.width/2, skull.y + skull.height/2 - 5);
                    ctx.font = 'bold 16px Arial';
                    ctx.fillText('BOSS', skull.x + skull.width/2, skull.y + skull.height/2 + 15);
                    
                    ctx.restore();
                });
                
                // –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
                if (countdownActive) {
                    ctx.save();
                    ctx.fillStyle = '#ff6b35';
                    ctx.font = 'bold 120px Arial';
                    ctx.textAlign = 'center';
                    ctx.shadowColor = '#000';
                    ctx.shadowBlur = 10;
                    ctx.fillText(countdownNumber.toString(), w/2, h/2 + 40);
                    ctx.shadowBlur = 0;
                    ctx.restore();
                }
                
                // –ß–∞—Å—Ç–∏—Ü—ã
                particles.forEach(p => {
                    ctx.save();
                    ctx.fillStyle = p.color;
                    ctx.globalAlpha = p.life / 30;
                    ctx.fillRect(p.x, p.y, 4, 4);
                    ctx.restore();
                });
            }
            
            function gameLoop(currentTime = 0) {
                if (gameState !== 'playing') return;
                
                const dt = (currentTime - lastTime) / 16.67; // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫ 60 FPS
                lastTime = currentTime;
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
                updatePlayer(dt);
                
                // –°–ø–∞–≤–Ω –æ–±—ä–µ–∫—Ç–æ–≤
                spawnObstacle();
                spawnBonus();
                spawnDebuff();
                spawnBoss();
                spawnSpeedSkull();
                spawnBlackDebuff();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
                updateCountdown();
                updateSlowDebuff();
                updateBlackDebuff();
                
                // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
                updateObjects(dt);
                updateParticles();
                
                // –°–∫—Ä–∏–º–µ—Ä—ã
                if (Math.random() < 0.001) {
                    triggerScreamer();
                }
                
                // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                if (score > 0 && score % 100 === 0) {
                    gameSpeed += 0.1;
                    level = Math.floor(score / 100) + 1;
                    updateHUD();
                }
                
                // –†–µ–Ω–¥–µ—Ä
                render();
                
                // –°–ª–µ–¥—É—é—â–∏–π –∫–∞–¥—Ä
                requestAnimationFrame(gameLoop);
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            updateHUD();
        })();
    </script>
</body>
</html>
